# PRD: Syrano - 연애 채팅 도우미 앱

## 1. 개요

### 1.1 프로젝트 소개
**Syrano(시라노)**는 연애 상황에서 적절한 메시지를 작성하는 데 어려움을 겪는 사용자를 돕는 AI 기반 채팅 도우미 모바일 애플리케이션입니다. 사용자가 채팅 상황이나 스크린샷을 제공하면, AI가 맥락에 맞는 여러 가지 응답 문구를 추천해줍니다.

### 1.2 프로젝트 목표
- 사용자의 연애 채팅 상황에 맞는 자연스럽고 효과적인 메시지 제안
- OCR 기술을 활용하여 스크린샷 기반 입력 지원
- 다양한 관계 유형, 말투, 톤에 맞춘 개인화된 추천 제공
- 프리미엄 구독 모델을 통한 수익화

### 1.3 타겟 유저
- 연애 초기 단계에서 메시지 작성에 어려움을 겪는 20-30대
- 소개팅이나 첫 만남 이후 연락을 이어가고 싶은 사용자
- 좀 더 매력적이고 자연스러운 대화를 원하는 사용자

## 2. 현재 구현 상태 (Phase 1)

### 2.1 기술 스택
- **Frontend**: Flutter (Dart)
- **Backend**: DigitalOcean 호스팅 (https://syrano-be-ekalw.ondigitalocean.app)
- **주요 라이브러리**:
  - `http`: REST API 통신
  - `shared_preferences`: 로컬 데이터 저장 (사용자 세션)

### 2.2 아키텍처

```
lib/
├── main.dart                          # 앱 진입점
├── screens/
│   └── home_screen.dart              # 메인 화면 (채팅 추천 UI)
├── services/
│   └── api_client.dart               # API 통신 레이어
└── models/
    ├── user_session.dart             # 사용자 세션 모델
    └── rizz_response.dart            # AI 응답 모델
```

### 2.3 구현 완료 기능

#### 2.3.1 인증 및 사용자 관리
- **익명 로그인** ([api_client.dart:20](lib/services/api_client.dart#L20))
  - 앱 실행 시 자동으로 익명 사용자 ID 생성
  - SharedPreferences에 user_id 저장하여 재방문 시 유지

#### 2.3.2 구독 관리
- **구독 상태 조회** ([api_client.dart:43](lib/services/api_client.dart#L43))
  - 사용자의 프리미엄 구독 여부 확인

- **월 구독 신청** ([api_client.dart:61](lib/services/api_client.dart#L61))
  - 테스트용 구독 기능 (실제 결제 연동 전)

#### 2.3.3 AI 메시지 생성
- **텍스트 기반 메시지 추천** ([api_client.dart:80](lib/services/api_client.dart#L80))
  - 사용자가 입력한 상황에 맞는 3개의 메시지 제안
  - 다음 파라미터 지원:
    - `mode`: 현재는 'conversation'만 지원
    - `platform`: 카카오톡 등 플랫폼 (기본값: 'kakao')
    - `relationship`: 관계 유형 (기본값: 'first_meet')
    - `style`: 말투 스타일 (기본값: 'banmal')
    - `tone`: 톤 (기본값: 'friendly')
    - `num_suggestions`: 추천 개수 (기본값: 3)

#### 2.3.4 UI/UX
- **메인 화면** ([home_screen.dart](lib/screens/home_screen.dart))
  - 상황 입력용 멀티라인 텍스트 필드
  - "문장 만들어줘" 버튼
  - 추천 문장 리스트 (카드 형태)
  - 프리미엄 사용자 뱃지 표시
  - 클립보드 복사 버튼 (TODO: 미구현)
  - 테스트용 구독 제어 UI

### 2.4 API 엔드포인트

| 메서드 | 경로 | 설명 | 상태 |
|--------|------|------|------|
| POST | `/auth/anonymous` | 익명 로그인 | ✅ 완료 |
| GET | `/auth/me/subscription` | 구독 상태 조회 | ✅ 완료 |
| POST | `/billing/subscribe` | 월 구독 신청 | ✅ 완료 |
| POST | `/rizz/generate` | AI 메시지 생성 | ✅ 완료 |

### 2.5 데이터 모델

#### UserSession
```dart
{
  "user_id": String,      // 익명 사용자 고유 ID
  "is_premium": bool      // 프리미엄 구독 여부
}
```

#### RizzResponse
```dart
{
  "suggestions": List<String>  // AI가 생성한 메시지 목록
}
```

## 3. 다음 구현 예정 기능 (Phase 2)

### 3.1 OCR 기반 스크린샷 입력
**우선순위: 높음**

#### 3.1.1 기능 설명
사용자가 채팅 앱의 스크린샷을 업로드하면, OCR 기술을 사용하여 대화 내용을 자동으로 추출하고 AI가 맥락을 파악하여 적절한 응답을 추천합니다.

#### 3.1.2 필요한 작업
- **Frontend**:
  - 이미지 선택 기능 추가 (`image_picker` 패키지)
  - 카메라/갤러리에서 이미지 가져오기 UI
  - 이미지 프리뷰 화면
  - 이미지 업로드 로직

- **Backend**:
  - 이미지 업로드 엔드포인트 구현
  - OCR API 연동 (Google Vision API, Naver Clova OCR 등)
  - 추출된 텍스트를 conversation 필드로 전달하여 AI 추천 생성

- **API 변경**:
  - `POST /rizz/generate-from-image` 엔드포인트 추가 또는
  - 기존 `/rizz/generate` 엔드포인트에 이미지 업로드 지원 추가

#### 3.1.3 UX 플로우
1. 사용자가 "스크린샷으로 추천받기" 버튼 클릭
2. 카메라 또는 갤러리에서 이미지 선택
3. 이미지 프리뷰 및 확인
4. 서버로 이미지 업로드
5. OCR 처리 및 텍스트 추출
6. AI가 맥락 파악 후 메시지 추천
7. 추천 결과 표시

### 3.2 향상된 사용자 경험

#### 3.2.1 클립보드 복사 기능
- 추천 메시지를 클릭 한 번으로 클립보드에 복사
- `flutter/services` 패키지 활용
- 복사 완료 시 피드백 (스낵바 또는 토스트)

#### 3.2.2 커스터마이징 옵션 UI
현재는 기본값만 사용하고 있으나, 사용자가 다음 옵션을 선택할 수 있도록 UI 추가:
- 관계 유형: 첫 만남, 소개팅, 연인, 친구 등
- 말투: 반말, 존댓말, 격식체 등
- 톤: 친근한, 유머러스한, 진지한, 로맨틱한 등
- 플랫폼: 카카오톡, 문자, Instagram DM 등

#### 3.2.3 히스토리 기능
- 과거에 생성한 추천 메시지 저장
- 히스토리 화면에서 확인 가능
- 즐겨찾기 기능

### 3.3 결제 시스템 연동
**우선순위: 중간**

현재는 테스트용 구독 버튼만 있으며, 실제 결제 연동 필요:
- In-App Purchase (iOS: StoreKit, Android: Google Play Billing)
- `in_app_purchase` Flutter 패키지 사용
- 구독 플랜:
  - 무료: 하루 3회 제한
  - 프리미엄 (월 ₩4,900): 무제한 사용

### 3.4 추가 기능 아이디어

#### 3.4.1 상황별 템플릿
- "첫 인사", "식사 제안", "데이트 신청" 등 상황별 빠른 템플릿 제공
- 템플릿 선택 시 자동으로 상황 텍스트 입력

#### 3.4.2 A/B 테스트 및 피드백
- 추천받은 메시지를 실제로 사용했는지 여부 추적
- 어떤 메시지가 효과적이었는지 피드백 수집
- AI 모델 개선에 활용

#### 3.4.3 다국어 지원
- 영어, 일본어 등 다국어 추천 지원
- 국제 연애 상황 대응

## 4. 기술적 고려사항

### 4.1 성능
- 이미지 업로드 시 용량 최적화 (압축, 리사이징)
- OCR 처리 시간 단축을 위한 비동기 처리
- 캐싱 전략 (동일 요청에 대한 중복 API 호출 방지)

### 4.2 보안
- 사용자 업로드 이미지의 안전한 저장 및 삭제 정책
- 개인정보 보호 (채팅 내용은 서버에 장기 저장하지 않음)
- API 요청 Rate Limiting

### 4.3 확장성
- 사용자 증가에 따른 서버 스케일링
- AI 모델 성능 개선 및 업데이트
- 다양한 채팅 플랫폼 지원

## 5. 성공 지표 (KPI)

### 5.1 사용자 지표
- DAU (Daily Active Users)
- 월간 메시지 생성 횟수
- 사용자당 평균 세션 시간
- 재방문율 (Retention Rate)

### 5.2 비즈니스 지표
- 프리미엄 전환율 (Free to Premium Conversion)
- 월간 반복 수익 (MRR)
- 고객 생애 가치 (LTV)
- 이탈률 (Churn Rate)

### 5.3 품질 지표
- AI 추천 만족도 (사용자 피드백)
- 추천 메시지 사용률 (클립보드 복사율)
- OCR 정확도

## 6. 개발 로드맵

### 개발 전략 및 우선순위

**핵심 전략: OCR 우선 구현 → 기능 검증 → 디자인 개선**

#### 전략적 판단 근거
1. **핵심 가치 검증 우선**
   - 스크린샷 기반 입력은 이 앱의 **핵심 차별화 포인트**
   - 텍스트 직접 입력은 사용자 입장에서 번거로움
   - 기능이 실제로 잘 작동하는지를 빠르게 검증해야 함

2. **기술적 리스크 조기 감소**
   - OCR 정확도, 처리 속도, 다양한 채팅 UI 대응 등 불확실성이 큼
   - 디자인 작업 후 OCR 기술 문제 발견 시 전체 일정 지연 위험
   - 기술적 난관을 먼저 파악하고 해결하는 것이 안전

3. **개발 효율성**
   - OCR 플로우를 먼저 구현하면서 실제 사용 경험을 파악
   - 그 경험을 바탕으로 UI/UX를 디자인하면 더 나은 결과
   - 완성도 있는 디자인보다 **작동하는 핵심 기능**이 MVP의 우선순위

4. **리소스 최적화**
   - 기본 UI는 현재 작동 가능한 수준 (완벽하지 않아도 사용 가능)
   - 디자인 개선은 OCR이 검증된 후 투자해도 늦지 않음

### Phase 1: MVP (✅ 완료)
- ✅ 익명 로그인
- ✅ 텍스트 기반 메시지 추천
- ✅ 구독 상태 관리 (테스트용)
- ✅ 기본 UI/UX

### Phase 2: OCR 핵심 기능 구현 (🎯 현재 우선순위, 예상 1-2주)
**목표**: 핵심 차별화 기능 구현 및 기술적 검증

- 🔲 **이미지 업로드 기능**
  - `image_picker` 패키지 연동
  - 갤러리/카메라 선택 UI
  - 이미지 압축 및 최적화

- 🔲 **OCR 기능 통합**
  - Backend OCR API 구현 (Google Vision / Naver Clova OCR 평가)
  - 이미지 업로드 엔드포인트 (`POST /rizz/generate-from-image`)
  - OCR 텍스트 추출 및 AI 추천 연동

- 🔲 **최소한의 UX 개선**
  - 이미지 업로드 로딩 상태 표시
  - OCR 처리 진행률 표시
  - 에러 핸들링 (OCR 실패, 네트워크 오류 등)
  - 추출된 텍스트 확인/수정 UI

- 🔲 **기술 검증**
  - 다양한 채팅 앱 스크린샷 테스트 (카카오톡, 인스타그램, 문자 등)
  - OCR 정확도 측정
  - 처리 속도 벤치마크

### Phase 3: 디자인 개선 (OCR 검증 완료 후)
**목표**: OCR 플로우가 검증된 상태에서 세련된 UI/UX 적용

- 🔲 **전체 UI 리뉴얼**
  - frontend-design 스킬 활용
  - 모던하고 직관적인 디자인 시스템
  - 일관된 컬러/타이포그래피 적용

- 🔲 **인터랙션 개선**
  - 부드러운 애니메이션 (이미지 업로드, 추천 결과 등장)
  - Micro-interactions (버튼 피드백, 제스처 등)
  - 직관적인 네비게이션

- 🔲 **추가 UX 기능**
  - 클립보드 복사 기능 구현
  - 온보딩 화면
  - 빈 상태 디자인 개선

### Phase 4: 사용자 경험 확장 (예정)
- 🔲 커스터마이징 옵션 UI (관계 유형, 말투, 톤 선택)
- 🔲 히스토리 및 즐겨찾기
- 🔲 상황별 템플릿

### Phase 5: 수익화 및 확장 (예정)
- 🔲 실제 In-App Purchase 연동
- 🔲 다국어 지원
- 🔲 성능 최적화
- 🔲 마케팅 및 사용자 확보

## 7. 리스크 및 대응 방안

### 7.1 기술적 리스크
- **OCR 정확도 문제**:
  - 대응: 여러 OCR 엔진 테스트 후 최적 선택, 사용자가 수동으로 수정 가능한 UI 제공

- **AI 응답 품질**:
  - 대응: 지속적인 프롬프트 엔지니어링, 사용자 피드백 수집 및 반영

### 7.2 비즈니스 리스크
- **사용자 확보 어려움**:
  - 대응: 소셜 미디어 마케팅, 인플루언서 협업, 바이럴 콘텐츠 제작

- **프리미엄 전환율 저조**:
  - 대응: 무료 사용 제한 조정, 프리미엄 혜택 강화

### 7.3 법적/윤리적 리스크
- **개인정보 보호**:
  - 대응: 데이터 최소화 원칙, 명확한 개인정보처리방침, GDPR/개인정보보호법 준수

- **AI 윤리 문제** (부적절한 메시지 생성):
  - 대응: Content Moderation 시스템 구축, 신고 기능 추가

## 8. 참고사항

### 8.1 현재 코드베이스 주요 파일
- [main.dart](lib/main.dart): 앱 진입점 및 테마 설정
- [home_screen.dart](lib/screens/home_screen.dart): 메인 UI 화면
- [api_client.dart](lib/services/api_client.dart): REST API 통신 레이어
- [user_session.dart](lib/models/user_session.dart): 사용자 세션 데이터 모델
- [rizz_response.dart](lib/models/rizz_response.dart): AI 응답 데이터 모델

### 8.2 주요 TODO 항목
- [ ] [home_screen.dart:268](lib/screens/home_screen.dart#L268): 클립보드 복사 기능 구현
- [ ] OCR 기능 추가 (이미지 업로드 및 텍스트 추출)
- [ ] 실제 In-App Purchase 연동
- [ ] 커스터마이징 옵션 UI 추가
- [ ] 히스토리 저장 및 조회 기능

---

**문서 버전**: 1.1
**최종 수정일**: 2025-12-13
**작성자**: Development Team
**주요 변경사항 (v1.1)**: 개발 로드맵 재구성 - OCR 우선 구현 전략 반영
